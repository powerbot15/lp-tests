<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>External window page</h1>
<button id="send-event">Send event back</button>
<script>
    (function () {
        let source;
        let origin;
        console.log('Started')
        window.addEventListener("message", (event) => {
            console.dir(event);
            source = event.source;
            origin = event.origin;
            event.source.postMessage(
                "hi there yourself!  the secret response " + "is: rheeeeet!",
                event.origin
            );
        });
        const sendEvent = document.querySelector('#send-event');
        sendEvent.addEventListener('click', () => {
            source.postMessage("do_clear_history", origin);
        });
    })();
</script>
</body>
</html>